<!DOCTYPE html>

<html>
<head>
  <title>extractEntries.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>extractEntries.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>Auto-configures entrypoints for multi-page apps</p>
<p>In conjunction with the CommonsChunkPlugin produces optimal filesizes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
import fs from 'fs';

/**
 * @param {bool}   isDev
 * @param {string} host
 * @param {string} appDir
 * @param {string} [file]
 * @returns {*}
 */
function extract (isDev, host, appDir, file = 'entry.jsx') {</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>In development mode an additional ‘dev’ entry point is injected
(includes hot code loading and development server code)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">let</span> extras = {
    dev: [
      <span class="hljs-string">'webpack-dev-server/client?'</span> + host,
      <span class="hljs-string">'webpack/hot/dev-server'</span>
    ]
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Loop through child modules of appDir to create an object used by Webpack as
entrypoints keyed by folder name:</p>
<pre><code>./apps
├── about
│   ├── entry.jsx
│   └── index.jsx
└── home
    ├── entry.jsx
    └── index.jsx
</code></pre><p>becomes…</p>
<pre><code>{
  about: apps/about/entry.jsx,
  home:  apps/home/entry.jsx,
  dev:   [ <span class="hljs-comment">// Omitted in production</span>
    <span class="hljs-string">'webpack-dev-server/client?'</span> + host,
    <span class="hljs-string">'webpack/hot/dev-server'</span>
  ],
}
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">return</span> fs.readdirSync(appDir).reduce((ret, key) =&gt; {
    <span class="hljs-keyword">let</span> dir, stat;

    dir  = <span class="hljs-string">`<span class="hljs-subst">${appDir}</span>/<span class="hljs-subst">${key}</span>`</span>;
    stat = fs.statSync(dir);

    <span class="hljs-keyword">if</span> (stat.isDirectory()) {
      ret[key] = <span class="hljs-string">`<span class="hljs-subst">${dir}</span>/<span class="hljs-subst">${file}</span>`</span>;
    }

    <span class="hljs-keyword">return</span> ret;
  }, isDev ? extras : {});
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> extract;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
